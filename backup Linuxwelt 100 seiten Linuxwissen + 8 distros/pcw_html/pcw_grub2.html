<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
<title>LinuxWelt Ausgabe 1/2018 - Anleitungen - Grub2</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8" />
<meta http-equiv="Content-Language" content="de" />
<link rel="shortcut icon" href="../favicon.ico" />
<link href="pcw_style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.lightbox-0.5.js"></script>
<script type="text/javascript">
$(document).ready(function() {
  $("div#tux").fadeIn(2000);
});
$(function() {
  $('div.bild a').lightBox();
});
</script>
</head>
<body>
<div id="pagewrapper">
<div id="header_logo"><a href="../index.html"></a></div>
<div id="header"></div>
<div id="header_shadow"></div>

  <div id="sidebar">
    <ul>
    <li><a href="../index.html">&Uuml;bersicht</a></li>
    <li><a href="pcw_distris.html">Systeme<br/>auf DVD</a></li>
    <li><a href="pcw_software.html">Software auf <br/>DVD</a></li>
    <li><a href="pcw_extras.html">Extras und Tools</a></li>
    <li><a href="pcw_anleitungen.html">Anleitungen</a></li>
    <li><a href="pcw_ebook.html">LinuxWelt-Ebook</a>
    <li><a href="pcw_jahrgang.html">LinuxWelt Jahrgang 2017</a></li>     
    <li><a href="pcw_check.html">Wahl-O-Mat<br/>Distributionen</a></li>
    </ul>
    <br/>
    <br/>
    <br/>
    <br/>
    <div id="abo">
      <a href="http://www.idgshop.de/linuxwelt-magazin-abo-shop.htm?websale8=idg&amp;ci=linuxwelt" target="_blank"><img src="static_pics/pcw_abo.jpg" width="153"
      alt="linuxabo"/></a>
      <a href="http://www.idgshop.de/linuxwelt-magazin-abo-shop.htm?websale8=idg&amp;ci=linuxwelt" target="_blank">LinuxWelt im Abo</a>
    </div>
    <br/>
    <br/>
    <div id="sociallinks">
      <a href="http://www.pcwelt.de" target="_blank"><img src="static_pics/www.png" width="119" alt="PC WELT Im Web"/></a>
      <a href="http://www.facebook.com/pcwelt" target="_blank"><img src="static_pics/facebook.png" width="119" alt="PC WELT auf Facebook"/></a>
      <a href="http://twitter.com/pcwelt" target="_blank"><img src="static_pics/twitter.png" width="119" alt="PC WELT auf Twitter"/></a>
    </div>
  </div>

  <div id="main">
<br /><br />
<div class="headline"><span class="left"></span><span class="inner">
Den Bootloader Grub 2 reparieren
</span><span class="right"></span></div>
<br />
<p>Dieser Abschnitt erklärt, wie Sie den Bootloader Grub 2 mit Hilfe der Heft-DVD reparieren, wenn sich die installierten Betriebssysteme nicht mehr starten lassen. Dieses Szenario tritt beispielsweise ein, wenn Windows nachträglich installiert wird, oder wenn bei einer Reparaturinstallation von Windows. Solange die Linux-Partitionen selbst intakt bleiben, ist ein Verlust des Bootmanagers von Grub 2 ist nicht weiter tragisch, da die Reparatur mit einfachen Mitteln möglich ist. </p>
<div class="bild"><a href="grub2_pics/grub2disk.png" title="Von Festplatte booten: Systemstart mit der Super Grub Disk 2"><img src="grub2_pics/thumb_grub2disk.png" border="0" alt="Super Grub Disk 2"></a></div>
<p><strong>Der Bootloader Grub 2</strong><br />
Nach dem Einschalten oder Neustart eines PCs arbeitet zunächst das BIOS die im ROM festgelegten Anweisungen ab, führt einen Selbsttest durch und durchsucht die angeschlossenen Laufwerke (Festplatte, CD/DVD, USB) nach einem Bootsektor. In diesem Bootsektor, beispielsweise der MBR (Master Boot Record) bei Festplatten, stehen die Anweisungen, wie und wo ein installiertes Betriebssystem zu starten ist. Wegen einer historisch bedingten Größenbeschränkung 
auf 512 Byte kann der Code des Master Boot Record nur sehr einfache Befehle ausführen. Der MBR enthält deshalb gerade genügend Befehle, um die nächsten Schritte des Systemstarts einzuleiten und einen Bootloader von der Festplatte zu starten, der alle weiteren Aktionen übernimmt. Ein Bootloader ist deshalb notwendig, um Betriebssysteme auf einem Computer überhaupt starten zu können.
<br /><br />
Bei aktuellen Linux-Systemen kommt meist der Bootloader Grub 2 (GRand Unified Bootloader 2) zum Einsatz. Die zweite Version von Grub bringt besseren Hardware-Support und Unterstützung aktueller Dateisysteme mit. 
<br /><br />
Da Windows nur den Master Boot Record (MBR) überschreibt, die Linux-Partitionen selbst aber in Ruhe lässt, brauchen Sie nur den MBR mit Hilfe von Grub 2 neu zu schreiben. Das Linux-System selbst muss dazu nicht bootfähig sein. Sie haben zwei Möglichkeiten zur Reparatur: entweder die LinuxWelt-DVD, die die Reparaturumgebung Super Grub 2 Disk enthält. Oder Sie nehmen eine Live-CD der installierten Linux-Distribution.
</p>
<div class="bild"><a href="grub2_pics/grubfix.png" title="Möglichkeit 1: Reparatur mit dem installierten Linux-System"><img src="grub2_pics/thumb_grubfix.png" border="0" alt="Grub 2 Reparatur"></a></div>
<p><strong>Möglichkeit 1: Reparatur mit Super Grub Disk 2</strong><br />
Möglichkeit 1 ist die einfachste und unkomplizierteste Reparatur, da Sie damit einfach das bereits installierte Linux über einen externen Grub 2 starten. Wenn das Linux-System einmal läuft, installieren Sie von dort aus den Bootloader neu. <br />
Starten Sie den PC von der LinuxWelt-DVD und booten Sie im Untermenü „Extras und Tools“ den Eintrag „Super Grub Disk 2“. Das startet direkt von DVD eine Notfallversion von Grub 2, die Ihnen hilft, das gewünschte Linux-System von Festplatte zu booten. Im Menü der Super Grub Disk 2 gehen Sie auf den Eintrag „Detect any Grub 2 Installation (even if mbr is overwritten)“. Anschließend überprüft das Tool die Festplatten nach einem Grub-2-Bootmanager und zeigt den Pfad zur Bestätigung an, wenn es etwas gefunden hat. Danach können Sie das Linux-System über das gewohnte Bootmenü des installierten Bootmanagers starten. Im laufenden System öffnen Sie eine Konsole oder ein Fenster der Eingabeaufforderung und geben dort die beiden Befehle
</p>
<p class="cmd">
grub-install --recheck /dev/sdX<br />
update-grub
</p>
<p>mit root-Rechten ein, oder mit vorangestelltem sudo. Anstatt des Platzhalters <em>X</em> geben Sie die Kennung der Festplatte ein, die vom BIOS des PCs gebootet wird. In den meisten Fällen ist dies die Partition /dev/sda. Das ist nicht die Systempartition, sondern die Festplatte, die den MBR des Bootloaders enthält. Grub 2 erstellt ein neues Bootmenü mit allen erkannten Betriebssystemen und schreibt dann den MBR neu. </p>
<div class="bild"><a href="grub2_pics/grub2live.png" title="Möglichkeit 2: Der mount-Befehl bindet erst die Systempartition /dev/sdb1 ein"><img src="grub2_pics/thumb_grub2live.png" border="0" alt="Grub 2 Reparatur"></a></div>
<p><strong>Möglichkeit 2: Reparatur mit Live-System </strong><br />
Wenn die Super Grub Disk 2 das installierte Betriebssystem nicht erkennt, dann können Sie die Reparatur von Grub 2 auch mit einer Live-CD durchführen. Die Live-CD muss dabei das Live-System der installierten Distribution sein. Achten Sie darauf, dass es sich um die gleiche Version handelt, da unterschiedliche Versionen von Grub 2 nicht immer kompatibel sind. Wenn Sie also ein Ubuntu 12.04 reparieren möchten brauchen Sie eine Live-CD von Ubuntu/Kubuntu/Xubuntu/Lubuntu 12.04.<br />
Vom gestarteten Live-System aus finden Sie zuerst heraus, auf welcher Partition das Linux-System installiert ist. Bei der Identifikation der korrekten Partition hilft das Kommando <em>sudo fdisk -l</em> oder der Partitionierer Gparted, der in vielen Live-Systemen enthalten ist. In diesem Beispiel gehen wir davon aus, dass Linux auf der Partition /dev/sdb1 installiert ist und die Festplatte /dev/sda1 den Master Boot Record enthält, der vom BIOS gebootet wird. Geben Sie diese beiden Befehle mit root-Rechten oder mit Hilfe von <em>sudo</em> in der Konsole ein:
</p>
<p class="cmd">
sudo mount /dev/sdb1 /mnt<br />
sudo grub-install --root-directory=/mnt /dev/sda
</p>
<p>
Wenn alles geklappt hat, bekommen Sie nach dem nächsten Neustart ein neues Grub-2-Menü angezeigt, das Einträge für alle installierten und erkannten Betriebssysteme enthält. Sollte es nicht klappen, so liegt dies meist an einer separaten /boot-Partition des Linux-Systems.
</p>
<p>
<strong>Möglichkeit 3: Reparatur bei separater /boot-Partition</strong><br />
Bei einer separaten Partition für /boot müssen Sie bei der Reparatur noch einen Zwischenschritt einschieben. In diesem Fall liegt Grub 2 nicht einfach auf der Systempartition des Linux-Systems, sondern auf /boot. Um Grub 2 zu reparieren, brauchen Sie Zugriff auf /boot und auf die Systempartition. Finden Sie zuerst mit „ sudo fdisk -l“ oder mit Gparted heraus, welche Kennung (/dev/sdXY) die Partition /boot bei Ihnen hat und welche Kennung die Systempartition besitzt. Angenommen, die Partition /boot hat die Kennung /dev/sdb6 und die Systempartition hat die Kennung /dev/sdb1, geben Sie diese Befehle im Live-System ein:
</p>
<p class="cmd">
sudo mount /dev/sdb1 /mnt
</p>
<p>
Anschließend hängen Sie die /boot-Partition des installierten Systems ein:
</p>
<p class="cmd">
sudo mount /dev/sda6 /mnt/boot
</p>
<p>
Beachten Sie, dass Sie die Partitionen immer in dieser Reihenfolge einhängen müssen. Der originale Inhalt eines Verzeichnisses ist nämlich nicht mehr sichtbar, wenn Sie eine Partition darin einhängen. Dies bedeutet: Erst die Systempartition einhängen und anschließend in das Unterverzeichnis /boot die Partition von /boot einhängen. <br />
Jetzt können Sie Grub 2 neu installieren, in diesem Fall in den Master Boot Record der Festplatte /dev/sda, die vom BIOS des PCs nach dem Bootsektor durchsucht wird:
</p>
<p class="cmd">
sudo grub-install --root-directory=/mnt /dev/sda
</p>
<p>
Abschließend können Sie den Rechner neu starten und die DVD des Live-Systems entnehmen. Hat alles funktioniert, meldet sich nach beim nächsten Neustart wieder das Bootmenü von Grub 2 mit allen Einträgen von der Festplatte. Sollte es nicht geklappt haben, überprüfen Sie die Partitionskennungen. Falsche Partitionsangaben sind bei dieser Reparaturmöglichkeit die häufigste Fehlerquelle.
</p>
<br />
<br />
<br />
<br />
</div>
</div>

<div id="footer">

<div id="footercontact">
<a href="pcw_impressum.html">Kontakt | Impressum</a>
</div>

<div id="copy">Copyright &copy; 2017 David Wolski </div>

</div>

</body>
</html>
